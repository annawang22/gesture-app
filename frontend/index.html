<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gesture Label Demo</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 900px; margin: 24px auto; padding: 0 16px; }
    video, canvas { border: 1px solid #ddd; border-radius: 12px; }
    button { padding: 10px 14px; border-radius: 12px; border: 1px solid #ccc; background: #fff; cursor: pointer; margin-right: 8px; }
    pre { background: #fafafa; border: 1px solid #eee; padding: 12px; border-radius: 12px; }
  </style>
</head>
<body>
  <h2>Gesture Label Demo</h2>

  <div>
    <button id="start">Start Camera</button>
    <button id="snap">Capture & Send</button>
  </div>

  <p><strong>Label:</strong> <span id="label">—</span></p>

  <video id="video" width="420" height="315" autoplay playsinline></video>
  <canvas id="canvas" width="420" height="315" style="display:block; margin-top:10px;"></canvas>

  <pre id="out">{}</pre>

  <script>
    // IMPORTANT: replace this after you deploy backend on Render
    let BACKEND_URL = "https://gesture-app-backend.onrender.com/predict";

    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const out = document.getElementById("out");
    const label = document.getElementById("label");

    document.getElementById("start").onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
      video.srcObject = stream;
    };

    document.getElementById("snap").onclick = async () => {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      const blob = await new Promise(res => canvas.toBlob(res, "image/jpeg", 0.92));
      const form = new FormData();
      form.append("image", blob, "capture.jpg");

      out.textContent = "Sending...";
      label.textContent = "…";

      const resp = await fetch(BACKEND_URL, { method: "POST", body: form });
      const data = await resp.json();

      out.textContent = JSON.stringify(data, null, 2);
      label.textContent = data.label ?? "None";
    };
  </script>
</body>
</html>
